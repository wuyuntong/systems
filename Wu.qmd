---
title: "lab assignment"
author: "Yuntong Wu"
format: html
editor: visual
---
GitHub link: https://github.com/wuyuntong/systems

```{r warning=FALSE}
here::i_am("systems.Rproj")
library(here)
library(vroom)
library(dplyr)
library(tidyr)
library(ggplot2)
library(knitr)
theme_set(theme_bw())
```
## Question 3
```{r}
sys <- vroom(here("data", "all-systems.csv"))
```

```{r}
sys <- sys |> mutate(`Star Mass` = as.numeric(gsub(",", ".", sys$`Star Mass`)),
                     `RELATIVE RADIUS` = as.numeric(gsub(",", ".", `RELATIVE RADIUS`)),
                     `Star Luminosity` = as.numeric(gsub(",", ".",  `Star Luminosity`)))
```

## Question 4
```{r}
colSums(is.na(sys)) > 0
```
```{r}
sys |> summarise(n_obs = nrow(sys), n_var = ncol(sys), n_missing_star_mass = sum(is.na(sys$`Star Mass`)), n_missing_star_luminosity = sum(is.na(sys$`Star Luminosity`)), n_obs_missing = sum(rowSums(is.na(sys)) > 0)) |> knitr::kable()
```
## Question 5
```{r}
sys |> ggplot(aes(x = `Star Mass`, y = `Star Luminosity`)) +
  geom_point(na.rm = TRUE)
```
## Question 6
```{r}
index = c(which.min(sys$DISTANCE),
          which.max(sys$DISTANCE),
          which.min(sys$`EQUIVALENT TEMPERATURE`),
          which.max(sys$`EQUIVALENT TEMPERATURE`),
          which.min(sys$`Star Mass`),
          which.max(sys$`Star Mass`),
          which.min(sys$`RELATIVE RADIUS`),
          which.max(sys$`RELATIVE RADIUS`),
          which.min(sys$`Star Luminosity`),
          which.max(sys$`Star Luminosity`))

stars <- sys[index,]$star

extreme <- c("min_dist", "max_dis", "min_temp", "max_temp", "min_mass", "max_mass", "min_rad", "max_rad", "min_lum", "max_lum")

data.frame(extreme, names) |> knitr::kable()

```

## question 8
```{r}
fac <- vroom(here("data", "factions.csv"))
facsys <- vroom(here("data", "Factionsystem.csv"))
```
## question 9
```{r}
facsys |> summarise(n_A = sum(facsys$Faction_key == "A"), n_I = sum(facsys$Faction_key == "I"), n_U = sum(facsys$Faction_key == "U"))
```

## question 10
```{r}
length(setdiff(fac$Faction_key, facsys$Faction_key))
```
```